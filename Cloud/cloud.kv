#:import Screen kivy.uix.screenmanager
#:import ScreenManager kivy.uix.screenmanager
#:import get_color_from_hex kivy.utils.get_color_from_hex
#:import ScrollEffect kivy.effects.scroll.ScrollEffect
#:import FloatScrollEffect mahartstudios.scroll.FloatScrollEffect
#:import Effects mahartstudios.effects.Effects

#:import os os

# This is the kv design for UniCloud

<Label>:
	color: 0,0,0,1
    font_name: 'comic'
<Button>:
	color: 0,0,0,1
    font_name: 'comic'

<Spinner>:
    background_normal: 'spinner.png'


<CircleBtn@Button>:
    source: ''
    background_normal: ''
    background_color: get_color_from_hex('#FF9966')
    color: (1, 1, 1, 1)
    Image:
        size: root.size
        pos: root.pos
        source: root.source

<Course_btn>:
    size_hint: (1, None)
    height: '60dp'
    background_normal: ''
    course_data: {'title':'','code':'','code_with_title':''}
    canvas.after:
        Color:
            rgba: .8, .8, .8, .6
        Line:
            points: [self.x+10, self.y, self.width-10, self.y]
            width: 1.4
            Color:
                rgba: (.5, .5, .5, .8) if root.selected else (0, 0, 0, 0)
            Rectangle:
                pos: root.pos
                size: root.size
    BoxLayout:
        size: root.size
        pos: root.pos
        Label:
            canvas.before:
                Color:
                    rgba: get_color_from_hex('#FFE099')
                Ellipse:
                    size: 50, 50
                    pos: self.center_x-25, self.center_y-25
            size_hint_x: None
            width: '100dp'
            text: root.course_data['code']
            font_size: '12dp'
            color: get_color_from_hex('#666666')
        Label:
            text_size: self.size
            halign: 'left'
            valign: 'center'
            text: root.course_data['code_with_title']
            markup: True

<Material_btn>:
    size_hint: (1, None)
    height: '60dp'
    material_data: {'name':'','user':'','size':''}
    canvas.after:
        Color:
            rgba: .8, .8, .8, .6
        Line:
            points: [self.x+10, self.y, self.width-10, self.y]
            width: 1.4
    BoxLayout:
        size: root.size
        pos: root.pos
        Image:
            canvas.before:
                Color:
                    rgba: get_color_from_hex('#FFE099')
                Ellipse:
                    size: 50, 50
                    pos: self.center_x-25, self.center_y-25
            size_hint_x: None
            width: '100dp'
            source: 'doc.png'
        BoxLayout:
            orientation: 'vertical'
            Label:
                text_size: self.size
                halign: 'left'
                valign: 'center'
                text: root.material_data['name']
                markup: True
                font_size: '16dp'
                color: get_color_from_hex('#444444')
                font_name: 'comic'
            BoxLayout:
                Label:
                    size_hint_x: .7
                    text_size: self.size
                    halign: 'left'
                    valign: 'center'
                    text: root.material_data['user']
                    markup: True
                    font_size: '12dp'
                    color: get_color_from_hex('#666666')
                Label:
                    background_color: 1, 1, 1, 1
                    size_hint_x: None
                    width: '60dp'
                    text: root.material_data['size']
                    color: get_color_from_hex('#666666')
                    font_size: '12dp'


<NavDropButton@DropButton>:
    canvas_shape: 'RoundedRectangle'
    background_color: 1,1,1,1
    on_state: toggle.state = self.state
    BoxLayout:
        size: self.size
        pos: self.pos
        Image:
			size_hint_x: None
			width: '50dp'
            source: 'settings.png'
        Label:
            text_size: self.size
        	padding: '20dp', 0
            halign: 'left'
            valign: 'middle'
            text: 'Student tools'
            text_size: self.size
        IconToggle:
            id: toggle
			size_hint_x: None
			width: '50dp'
            normal_source: 'tree_closed.png'
            down_source: 'tree_opened.png'
            on_state: root.state=self.state



NavigationDrawer:
    anim_type: 'slide_above_simple'
    side_panel_width: min(dp(250), 0.65*self.width)
    ScrollView:
        canvas.before:
            Color:
                rgba: get_color_from_hex('#FF9966')
            Rectangle:
                size: self.size
                pos: self.pos

        GridLayout:
            size_hint_y: None
            height: self.minimum_height
            id: menu
            spacing: 1
            padding: 2
            orientation: 'vertical'
            cols: 1

            BoxLayout:
                size_hint_y: None
                height: '50dp'
                Label:
                    text: 'UniCloud'
                    color: 1,1,1,1
                    font_size: '18dp'
                IconButton:
                    icon_source: 'arrow_back1.png'
                    size_hint_x: None
                    width: '50dp'
                    on_release: root.toggle_state(True)
                    normal_color: get_color_from_hex('#ff9966')

            LeftIconButton:
                text: 'Home'
                size_hint_y: None
                height: '50dp'
                icon_source: 'home.png'
                on_release: root.toggle_state(True);_manager_.go_to_page('home_page')

            LeftIconButton:
                text: 'Downloads'
                size_hint_y: None
                height: '50dp'
                icon_source: 'download.png'
                on_release: root.toggle_state(True); _manager_.go_to_page('download_page')

            LeftIconButton:
                text: 'Pdf Maker'
                size_hint_y: None
                height: '50dp'
                icon_source: 'pdf.png'
                on_release:
                    root.toggle_state(True); _manager_.go_to_page('pdf_maker');
                    _manager_.parent.allow_touch_drag= False;

            LeftIconButton:
                text: 'Settings'
                size_hint_y: None
                height: '50dp'
                icon_source: 'settings.png'
                on_release: root.toggle_state(True); #_manager_.current ='settings page';

            NavDropButton:
                BoxLayout:
                    size_hint_y: None
                    height: self.minimum_height
                    orientation: 'vertical'
                    NormalButton:
                        size_hint_y: None
                        height: '40dp'
                        text: 'Gp Calculator'
                        on_release: _manager_.go_to_external_page('calculator'); root.toggle_state(True);
                    NormalButton:
                        size_hint_y: None
                        height: '40dp'
                        text: 'Matic Detector'
                        on_release: root.toggle_state(True); _manager_.go_to_external_page('detector_page');

            BoxLayout:
                spacing: 1
                size_hint_y: None
                height: '100dp'
                Button:
                    background_normal: ''
                    background_color: (1, 1, 1, 1)
                    BoxLayout:
                        orientation: 'vertical'
                        pos: self.parent.pos
                        size: self.parent.size
                        BoxLayout:
                            size_hint_y: .5
                            Image:
                                source: 'ic_action_star_10.png'
                            Image:
                                source: 'ic_action_star_5.png'
                            Image:
                                source: 'ic_action_star_0.png'
                        Label:
                            color: (0, 0, 0, 1)
                            text: 'Rate Us'

                Button:
                    background_normal: ''
                    background_color: (1, 1, 1, 1)
                    color: (0, 0, 0, 1)
                    BoxLayout:
                        orientation: 'vertical'
                        pos: self.parent.pos
                        size: self.parent.size
                        Image:
                            source: 'ic_action_share.png'
                            size_hint_y: .5
                        Label:
                            color: (0, 0, 0, 1)
                            text: 'Share'

    Manager:
        id: _manager_

<Manager>:


<HomePage>:
    on_enter:
        try: root.manager.parent.allow_touch_drag= True
        except Exception: pass
    FloatLayout:
        BoxLayout:
            id: my_parent
            orientation: 'vertical'
            canvas.before:
                Color:
                    rgba: get_color_from_hex('#FF9966')
                Rectangle:
                    pos: self.pos
                    size: self.size
        #Actiion Bar
            BoxLayout:
                size_hint: (1, None)
                height: '50dp'

                IconButton:
                    normal_color: get_color_from_hex('#ff9966')
                    size_hint: None, 1
                    size: '50dp', '32dp'
                    icon_source: 'menu.png'
                    on_release: root.manager.parent.parent.toggle_state(False)

                Image:
                    source: 'ic_action_cloudy.png'
                    size: '32dp', '32dp'
                    size_hint_x: None

                Label:
                    text: '[b]UniCloud[/b]'
                    font_size: '22dp'
                    font_name: 'comic'
                    text_size: self.size
                    color: 1,1,1,1
                    markup: True
                IconButton:
                    normal_color: get_color_from_hex('#ff9966')
                    icon_source: 'search.png'
                    size_hint: None, 1
                    size: '40dp', '32dp'
                    on_release: root.manager.go_to_page('search_page')
            Label:
                size_hint_y: None
                height: '10dp'

            AndroidTabs:
                canvas.before:
                    Color:
                        rgba: 1,1,1,1
                    Rectangle:
                        size: self.size
                        pos: self.pos
                MyIconTab:
                    text: 'All Course'
                    image_active: 'All Course.png'
                    image_normal: 'All Course1.png'
                    UniCycle:
                        viewclass: 'Course_btn'
                        id: all_course_scroll
                        # text_effect: FloatScrollEffect(self, 60, color=get_color_from_hex('#ff6600'))
                MyIconTab:
                    text: 'Label'
                    image_normal: 'Your Course1.png'
                    image_active: 'Your Course.png'
                    UniCycle:
                        viewclass: 'Course_btn'
                        id: your_course_scroll
                        data: [{'text':'No courses Selected Yet','color': (.7, .7, .7, 1)}]
                        
                MyIconTab:
                    text: 'Uploads'
                    image_active: 'uploads1.png'
                    image_normal: 'uploads.png'
                    BoxLayout:
                        orientation: 'vertical'
                        CustScroll:
                            size_hint: (1, 1)
                            size: self.size
                            GridLayout:
                                id: downloads_scroll
                                height: self.minimum_height
                                cols: 1
                                size_hint: (1, None)

                MyIconTab:
                    text: 'Accounts'
                    image_active: 'Accounts.png'
                    image_normal: 'Accounts1.png'

        CircleBtn:
            background_color: 0, 0, 0, 0
            size_hint: (None, None)
            size: ('40dp', '40dp')
            pos_hint: {'x': .8,  'y': .05}
            source: 'float.png'
            color: (1, 1, 1, 1)
            on_release: root.manager.go_to_page("post_page")


<Add_Course>:
    on_pre_enter: root.manager.parent.allow_touch_drag= False
    FloatLayout:
        id: my_parent
        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            Rectangle:
                pos: self.pos
                size: self.size
        BoxLayout:
            orientation: 'vertical'
            BoxLayout:
                size_hint_y: None
                height: '50dp'
				IconButton:
					size_hint_x: None
					width: '64dp'
					background_color: 1,1,1,1
					icon_source: 'arrow_back.png'
                    on_release: root.manager.go_to_page('post_page')


                Label:
                    text: 'Add Course'
                    color: get_color_from_hex('#FF9900')
                    font_size: '18dp'
                    bold: True
                    text_size: self.size
                    valign: 'middle'
                    halign: 'left'
                    padding: '20dp', 0
                Button:
                    text: 'Add'
                    bold: True
                    size_hint_x: None
                    width: '100dp'
                    color: get_color_from_hex('#FF9966')
                    background_color: 1,1,1,1
                    background_normal: ''
                    background_down: ''
                    background_color: (1,1,1,0) if self.state == 'normal' else (0,0,0,.2)

            FloatLayout:
                size_hint: (1, 1)
                CustLabel1:
                    text: 'Course Code'
                TextInput:
                    size_hint: (None, None)
                    size: ('150dp', '50dp')
                    pos_hint: {'center_x': .75, 'center_y': .5}
                    text: 'GEG 303'
                    multiline: False

            FloatLayout:
                size_hint: (1, 1)
                CustLabel1:
                    text: 'Course Title'
                TextInput:
                    size_hint: (None, None)
                    size: ('200dp', '50dp')
                    pos_hint: {'center_x': .75, 'center_y': .5}
                    text: 'Intro To Engineering Statistics'
                    multiline: False

            FloatLayout:
                size_hint: (1, 1)
                CustLabel1:
                    text: 'Department'
                Spinner:
                    size_hint: (None, None)
                    size: ('180dp', '40dp')
                    pos_hint: {'center_x': .75, 'center_y': .5}
                    text: 'Mechanical Engineering'
                    values: ('Mechanical Engineering', 'Chemical', 'Systems')

            FloatLayout:
                size_hint: (1, 1)
                CustLabel1:
                    text: 'Falculty'
                Spinner:
                    size_hint: (None, None)
                    size: ('180dp', '40dp')
                    pos_hint: {'center_x': .75, 'center_y': .5}
                    text: 'Engineering'
                    values: ('Medicine', 'Law')


<CustLabel1@Label>:
    size_hint: (.5, 1)
    pos_hint: {'center_x': .25, 'center_y': .5}
    color: (0, 0, 0, 1)

<PostScreen>:
    on_pre_enter: root.manager.parent.allow_touch_drag= False
    selected_file: None
    FloatLayout:
        canvas.before:
            Color:
                rgba: 1,1,1,1
            Rectangle:
                pos: self.pos
                size: self.size
        BoxLayout:
            orientation: 'vertical'
            BoxLayout:
                size_hint_y: None
                height: '50dp'
    			shadow: Effects(self).add_shadow()
				IconButton:
					size_hint_x: None
					width: '64dp'
					background_color: 1,1,1,1
					icon_source: 'arrow_back.png'
                    on_release: root.manager.go_to_page('home_page')

                Label:
                    text: 'Post A Material'
                    color: get_color_from_hex('#FF9900')
                    font_size: '18dp'
                    bold: True
                    text_size: self.size
                    valign: 'middle'
                    halign: 'left'
                    padding: '20dp', 0
                NormalButton:
                    text: 'Done'
                    bold: True
                    size_hint_x: None
                    width: '100dp'
                    color: get_color_from_hex('#FF9966')
                    on_release: root.upload_file(root.selected_file)

            ScrollView:
                size_hint: (1, 1)
                size: self.size
                GridLayout:
                    spacing: 1
                    height: self.minimum_height
                    id: form_scroll
                    size_hint_y: None
                    cols: 1
                    FloatLayout:
                        size_hint: (1, None)
                        hieght: '60dp'
                        CustLabel1:
                            text: 'Choose A File'
                        IconButton:
                            size_hint: (None, None)
                            size: ('80dp', '40dp')
                            pos_hint: {'center_x': .75, 'center_y': .5}
                            icon_source: 'add1.png'
                            on_release: root.manager.go_to_page('file_chooser')

					Button:
                        background_color: (1,1,1,0) if self.state == 'normal' else (0,0,0,.2)
                        background_normal: ''
						size_hint_y: None
						height: '20dp'
                        BoxLayout:
                            size_hint: None,None
                            size: self.parent.size
                            pos: self.parent.pos
                            Label:
        						text: 'No file selected'
                				id: selected_file
                                color: .5,.5,.5,1
                            Label:
                                size_hint_x: None
                                width: '100dp'
                                id: selected_mb
                                color: .5,.5,.5,1
                                font_size: '13dp'

                    BoxLayout:
                        size_hint: (1, None)
                        hieght: '60dp'
                        padding: '6dp'
                        spacing: '6dp'
                        CustLabel1:
                            text: 'Name Of Material'
                        TextInput:
                            size_hint: (None, None)
                            size: ('200dp', '50dp')
                            pos_hint: {'center_y': .5, 'center_x': .5}
                            text: ''

                    FloatLayout:
                        size_hint: (1, None)
                        hieght: '60dp'
                        CustLabel1:
                            text: 'Course'
                        Spinner:
                            size_hint: (None, None)
                            size: ('120dp', '40dp')
                            pos_hint: {'center_x': .75, 'center_y': .5}
                            text: 'GEG 303'
                            values: 'GEG 303', 'PHY 123', 'GST 101'

                    FloatLayout:
                        size_hint_y: None
                        height: '10dp'
                        Label:
                            size_hint_x: .5
                            pos_hint: {'x': .1, 'y': 0}
                            text: 'If Course Not Found Add To Database'
                            color: (.5, .5, .5, 1)
                            halign: 'left'
                            font_size: '12dp'
                        Button:
                            size_hint: (None, None)
                            size: ('10dp', '10dp')
                            pos_hint: {'x': .75, 'y': 0}
                            size: ('10dp', '10dp')
                            text: '+'
                            background_color: (.7, .7, .7, 1)
                            on_release: root.manager.go_to_page('add_course_page')

                    FloatLayout:
                        size_hint: (1, None)
                        hieght: '60dp'
                        CustLabel1:
                            text: 'Material Type'
                        Spinner:
                            size_hint: (None, None)
                            size: ('120dp', '40dp')
                            pos_hint: {'center_x': .75, 'center_y': .5}
                            text: 'Exam Question'
                            values: 'Exam Question', 'Lecture Note', 'Test', 'Assignment', 'Class Material'


                    FloatLayout
                        size_hint: (1, None)
                        hieght: '60dp'
                        CustLabel1:
                            text: 'Year'
                        Spinner:
                            size_hint: (None, None)
                            size: ('120dp', '40dp')
                            pos_hint: {'center_x': .75, 'center_y': .5}
                            text: '2018/2019'
                            values: ('2018/2019', '2017/2018', '2016/2017')


<SelectFile>:
    on_pre_enter: root.manager.parent.allow_touch_drag= False
    canvas.before:
        Color:
            rgba: .9,.9,.9,1
        Rectangle:
            size: self.size
            pos: self.pos
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            size_hint_y: None
            height: '50dp'
            IconButton:
                normal_color: .9,.9,.9,1
                icon_source: 'arrow_back.png'
                size_hint_x: None
                width: '50dp'
                on_release: root.manager.go_to_page('post_page')

            Label:
                color: get_color_from_hex('#FF9900')
                text: 'Select File'
                text_size: self.size
                padding: '40dp', '40dp'
                halign: 'left'
                valign: 'center'
                font_size: '22dp'
                markup: True

            NormalButton:
                text: 'Select'
                bold: True
                size_hint_x: None
                width: '100dp'
                color: get_color_from_hex('#FF9900')
                background_color: .9,.9,.9,1
                post_page: None
                on_release:
                    root.manager.go_to_page('post_page');
                    self.post_page =root.manager.get_screen('post_page')
                    self.post_page.ids.selected_file.text = os.path.split(file_chooser.selection[0])[1]
                    self.post_page.ids.selected_mb.text = str(file_chooser.get_nice_size(file_chooser.selection[0]));
                    self.post_page.selected_file=file_chooser.selection[0]

        FileChooserListView:
            progress_cls: 'MyFileProgressCls'
            id: file_chooser
            on_submit:
                root.manager.get_screen('post_page').ids.selected_file.text = os.path.split(self.selection[0])[1];
                root.manager.go_to_page('post_page');
                root.manager.get_screen('post_page').ids.selected_mb.text = str(self.get_nice_size(self.selection[0]));
                root.manager.get_screen('post_page').selected_file=self.selection[0]


<MyFileProgressCls@FileChooserProgressBase>:
    canvas.before:
        Color:
            rgba: 0,0,0,.4
        Rectangle:
            size: self.size
            pos: self.pos
    Image:
        canvas.before:
            Color:
                rgba: 1,1,1,1
            RoundedRectangle:
                size: self.size
                pos: self.pos
        pos_hint: {'center_y': .5, 'center_x': .5}
        size_hint: None,None
        size: '140dp', '140dp'
        source: 'comments-loader.gif'


<Course_Page>:
    on_pre_enter: root.manager.parent.allow_touch_drag= False
    FloatLayout:
        canvas.before:
            Color:
                rgba: get_color_from_hex('#FF9966')
            Rectangle:
                pos: self.pos
                size: self.size
        BoxLayout:
            orientation: 'vertical'
            BoxLayout:
                size_hint: (1, None)
                height: '80dp'
                IconButton:
                    icon_source: 'arrow_back1.png'
                    pos_hint: {'top': .9}
                    size_hint: (None, None)
                    size: '40dp', '32dp'
                    on_release: root.manager.go_to_page('home_page')
                    normal_color: get_color_from_hex('#ff9966')
                Label:
                    id: course_code
                    text: "[size=20dp][font=comic][color=#ffffff][b]ABS 101[/b][/font][/size]\n[size=15dp][color=#99330088]Intro to Computer Science[/color][/size][/color]"
                    markup: True
                    text_size: self.size
                    valign: 'middle'
                    halign: 'left'
                IconButton:
                    normal_color: get_color_from_hex('#ff9966')
                    pos_hint: {'top': .9}
                    size_hint: (None, None)
                    size: '40dp', '32dp'
                    icon_source: 'search.png'
                IconButton:
                    normal_color: get_color_from_hex('#ff9966')
                    pos_hint: {'top': .9}
                    size_hint: (None, None)
                    size: '40dp', '32dp'
                    icon_source: 'ic_action_overflow.png'

            FloatLayout:
                size_hint: (1, None)
                height: 40
                Label:
                    size_hint_x: None
                    width: self.parent.width
                    id: dept_fal
                    markup: True
                    font_size: '13dp'
                    text_size: self.size
                    valign: 'middle'
                    halign: 'left'
                    x: '40dp'
                    y: self.parent.y

            AndroidTabs:
                anim_threshold: 0
                default_tab: 2
                canvas.before:
                    Color:
                        rgba: 1, 1, 1, 1
                    Rectangle:
                        size: self.size
                        pos: self.pos

                MyTab:
                    text: 'Exam'
                    UniCycle:
                        viewclass: 'Material_btn'
                        id: exam_scroll
                MyTab:
                    text: 'Test'
                    CustScroll:
                        size_hint: (1, 1)
                        size: self.size
                        GridLayout:
                            id: test_scroll
                            cols: 1
                            size_hint: (1, None)
                            Label:
                                text: 'No Material Available'
                                color: (.4, .4, .4, 1)
                MyTab:
                    text: 'Course Material'
                    CustScroll:
                        size_hint: (1, 1)
                        size: self.size
                        GridLayout:
                            id: course_mat_scroll
                            cols: 1
                            size_hint: (1, None)
                            Label:
                                text: 'No Material Available'
                                color: (.4, .4, .4, 1)
                MyTab:
                    text: 'Assignment'
                    CustScroll:
                        size_hint: (1, 1)
                        size: self.size
                        GridLayout:
                            id: ass_scroll
                            cols: 1
                            size_hint: (1, None)
                            Label:
                                text: 'No Material Available'
                                color: (.4, .4, .4, 1)
                MyTab:
                    text: 'Class Note'
                    CustScroll:
                        size_hint: (1, 1)
                        size: self.size
                        GridLayout:
                            id: class_scroll
                            cols: 1
                            size_hint: (1, None)
                            Label:
                                text: 'No Material Available'
                                color: (.4, .4, .4, 1)


        CircleBtn:
            background_color: 0, 0, 0, 0
            size_hint: (None, None)
            size: ('40dp', '40dp')
            pos_hint: {'x': .8,  'y': .05}
            source: 'float.png'
            color: (1, 1, 1, 1)
            on_release: root.manager.go_to_page('add_course_page')

<SearchPage>:
    on_pre_enter: root.manager.parent.allow_touch_drag= False
    on_enter: search_input.focus = True
    BoxLayout:
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: 1,1,1,1
            Rectangle:
                size: self.size
                pos: self.pos
        BoxLayout:
            size_hint_y: None
            height: '50dp'
            canvas.before:
                Color:
                    rgba: get_color_from_hex('#FF9966')
                Rectangle:
                    size: self.size
                    pos: self.pos

            IconButton:
                icon_source: 'arrow_back1.png'
                size_hint_x: None
                width: '50dp'
                on_release: root.manager.go_to_page('home_page')
                normal_color: get_color_from_hex('#ff9966')

            CustomInput:
                id: search_input
                background_active: ''
                background_normal: ''
                background_color: get_color_from_hex('#FF9966')
                focus: True
                hint_text: 'Search'
                multiline: False
                foreground_color: .3,.3,.3,1
                padding: '20dp','18dp'

            IconButton:
                icon_source: 'search.png'
                size_hint_x: None
                width: '50dp'
                normal_color: get_color_from_hex('#ff9966')


        AndroidTabs:
            anim_threshold: 0
            default_tab: 2
            canvas.before:
                Color:
                    rgba: 1, 1, 1, 1
                Rectangle:
                    size: self.size
                    pos: self.pos

            MyTab:
                text: 'Courses'
                CustScroll:
                    size_hint: (1, 1)
                    size: self.size
                    GridLayout:
                        id: course_scroll
                        cols: 1
                        size_hint: (1, None)
                        Label:
                            text: 'Search for course'
                            color: (.4, .4, .4, 1)
            MyTab:
                text: 'Materials'
                CustScroll:
                    size_hint: (1, 1)
                    size: self.size
                    GridLayout
                        id: material_scroll
                        cols: 1
                        size_hint: (1, None)
                        Label:
                            text: 'Search for Materials'
                            color: (.4, .4, .4, 1)


<DownloadPage>:
    on_pre_enter: root.manager.parent.allow_touch_drag= True
    on_leave: android_tab.default_tab = 0
    canvas.before:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            size: self.size
            pos: self.pos

    BoxLayout:
        orientation: 'vertical'
        AndroidTabs:
            id: android_tab
            anim_threshold: 0
            canvas.before:
                Color:
                    rgba: 1, 1, 1, 1
                Rectangle:
                    size: self.size
                    pos: self.pos

            MyTab:
                text: 'Downloading'
                CustScroll:
                    size_hint: (1, 1)
                    size: self.size
                    GridLayout
                        id: downloading_grid
                        cols: 1
                        size_hint: (1, None)
                        height: self.minimum_height
                        # Label:
                        #     text: 'No Downloads'
                        #     color: (.4, .4, .4, 1)
                        #     size_hint_y: None
                        DownloadingButton:

            MyTab:
                text: 'Downloads'
                CustScroll:
                    size_hint: (1, 1)
                    size: self.size
                    GridLayout:
                        cols: 1
                        size_hint: (1, None)
                        height: self.minimum_height
                        # Label:
                        #     text: 'No Downloads'
                        #     color: (.4, .4, .4, 1)
                        #     size_hint_y: None
                        DownloadButton:
                        DownloadButton:
            MyTab:
                text: 'Download Later'
                UniCycle:
                    viewclass: 'Material_btn'
                    id: download_later


<DownloadButton@NormalButton>:
    shape: 'rectangle'
    size_hint_y: None
    height: '60dp'
    background_normal: ''
    canvas.after:
        Color:
            rgba: .8, .8, .8, .6
        Line:
            points: [self.x+10, self.y, self.width-10, self.y]
            width: 1.5
    BoxLayout:
        size: root.size
        pos: root.pos
        Image:
            canvas.before:
                Color:
                    rgba: get_color_from_hex('#FFE099')
                Ellipse:
                    size: 50, 50
                    pos: self.center_x-25, self.center_y-25
            size_hint_x: None
            width: '100dp'
            source: 'doc.png'
        BoxLayout:
            orientation: 'vertical'
            BoxLayout:
                Label:
                    text_size: self.size
                    halign: 'left'
                    valign: 'center'
                    id: mat_name
                    font_size: '16dp'
                    text: 'UniCloud.pdf'
                Label:
                    text: '9.8mb'
                    width: self.texture_size[0]+10


<DownloadingButton>:
    shape: 'rectangle'
    size_hint_y: None
    height: '60dp'
    background_normal: ''
    download_cls: root.download_cls
    canvas.after:
        Color:
            rgba: .8, .8, .8, .6
        Line:
            points: [self.x+10, self.y, self.width-10, self.y]
            width: 1.5
    BoxLayout:
        size: root.size
        pos: root.pos
        Image:
            canvas.before:
                Color:
                    rgba: get_color_from_hex('#FFE099')
                Ellipse:
                    size: 50, 50
                    pos: self.center_x-25, self.center_y-25
            size_hint_x: None
            width: '100dp'
            source: 'doc.png'
        BoxLayout:
            orientation: 'vertical'
            BoxLayout:
                Label:
                    text_size: self.size
                    halign: 'left'
                    valign: 'center'
                    id: mat_name
                    font_size: '16dp'
                    text: 'UniCloud.pdf'
                IconToggle:
                    down_source: 'pause.png'
                    normal_source: 'play.png'
                    size_hint_x: None
                    width: '100dp'
                    on_state:
                        if self.state =='down': download_cls.countinue()
                        else: download_cls.pause()

            BoxLayout:
                ProgressBar:
                    id: pb
                    value: 50
                    size_hint_x: 1
                Label:
                    size_hint_x: None
                    width: self.texture_size[0] + 4
                    text: '1.0/4mb'
                    color: get_color_from_hex('#666666')
                    font_size: '12dp'


<AndroidTabsLabel>:
    text_color_normal: get_color_from_hex('#CC6600')
    font_name: 'comic'
    bold: True

<IconTab>:
    text_color_normal: get_color_from_hex('#CC6600')

<MyIconTab@IconTabBase>:


<AndroidTabsBar>:
    canvas.before:
        Color:
            rgba: get_color_from_hex('#FF9966')
        Rectangle:
            pos: self.pos
            size: self.size

        # you can add a bit of shade if you want
        Color:
            rgba: 0,0,0,.3
        Rectangle:
            pos: self.pos[0], self.pos[1] - 1
            size: self.size[0], 1
        Color:
            rgba: 0,0,0,.2
        Rectangle:
            pos: self.pos[0], self.pos[1] - 2
            size: self.size[0], 1
        Color:
            rgba: 0,0,0,.05
        Rectangle:
            pos: self.pos[0], self.pos[1] - 3
            size: self.size[0], 1

<CustScroll@ScrollView>:
    bar_color: get_color_from_hex('#CC6600aa')
    bar_inactive_color: get_color_from_hex('#CC660033')
    bar_width: '6dp'
    bar_height: '5dp'
    scroll_type: ['bars', 'content']
    effect_cls: 'MyEffect'

<MyEffect@ScrollEffect>:
    min: 100
    max: 20
    # edge_damping: 20
    overscroll: 30

<AndroidTabsCarousel>:
    ignore_perpendicular_swipes: True


<MaterialOptions>:
    size_hint: None, None
    size: '300dp', '200dp'
    screen_name: root.screen_name
    stop_escape: False
    on_open: root.is_open =True
    on_dismiss: root.is_open =False; _manager_.current ='material'
    material_data: {'name':''}

    ScreenManager:
        id: _manager_
        current: root.screen_name
        canvas.before:
            Color:
                rgba: (1, 1, 1, 1)
            RoundedRectangle:
                pos: self.pos
                size: self.size

        Screen:
            name: 'material'
            BoxLayout:
                orientation: 'vertical'
                padding: 6
                Label:
                    text: root.material_data['name']
                    size_hint_y: None
                    height: '30dp'
                    bold: 'True'
                    canvas.after:
                        Color:
                            rgba: .5,.5,.5,.8
                        Line:
                            points: [self.x+6, self.y, self.x+self.width-6, self.y]
                            width: 1.4
                LeftIconButton:
                    text: 'Share'
                    icon_source: 'share.png'

                LeftIconButton:
                    text: 'Download'
                    on_release: _manager_.current = 'loading'; root.download_file();
                    icon_source: 'downloaded.png'

                LeftIconButton:
                    text: 'Download Later'
                    icon_source: 'Your Course1.png'
                    on_release: root.download_later(root.material_data)

        Screen:
            name: 'loading'
            BoxLayout:
                orientation: 'vertical'
                Label:
                    size_hint_y: None
                    height: '40dp'
                    padding: '20dp', '30dp'
                    text: 'Please Wiat'
                    bold: True
                    color: 0, 0, 0, 1
                    canvas.after:
                        Color:
                            rgba: 1,1,1,.6
                        Line:
                            points: [self.x+6, self.y, self.width-6, self.y]
                            width: 1
                Image:
                    source: 'comments-loader.gif'
                BoxLayout:
                    size_hint_y: None
                    height: '40dp'
                    padding: 6
                    Button:
                        text: "Cancel"
                        background_normal: ''
                        on_release: _manager_.current='downloading' #root.dismiss()
                        color: (0, 0, 0, 1)

        Screen:
            name: 'downloading'
            on_enter: root.ccc()
            BoxLayout:
                orientation: 'vertical'
                padding: '4dp'
                Label:
                    size_hint_y: None
                    height: '40dp'
                    padding: '20dp', '30dp'
                    text: 'Downloading....'
                    bold: True
                    color: 0, 0, 0, 1
                    canvas:
                        Color:
                            rgba: 1,1,1,.6
                        Line:
                            points: [self.x+6, self.y, self.width-6, self.y]
                            width: 1
                ProgressBar:
                    id: pb
                    value: root.pb_value
                Label:
                    size_hint_y: None
                    height: '10dp'
                    text: '[color=#222222]'+str(pb.value)+'[/color]' +'% of 12mb'
                    color: .45, .45, .45, 1
                    font_size: '12dp'
                    markup: True
                BoxLayout:
                    size_hint_y: None
                    height: '40dp'
                    padding: 6
                    Button:
                        text: "Stop"
                        background_normal: ''
                        on_release: root.dismiss()
                        color: (0, 0, 0, 1)
                    Button
                        text: 'Ok'
                        color: (0, 0, 0, 1)
                        background_normal: ''
                        on_release: root.dismiss(); root.take_to_download_page()

<CustomInput@TextInput>:
    background_active: ''
    background_normal: ''
    background_color: get_color_from_hex('#FF9966')
    focus: True
    text: 'Search'
    multiline: False
    color: 1,1,1,1
    padding: '20dp', '14dp',0,0
    canvas.after:
        Color:
            rgba: get_color_from_hex('#ff6600')
        Line:
            points: [self.x+6, self.y, self.x+self.width-6, self.y]

<SignLabel@Label>:
    size_hint_y: None
    height: '30dp'
    text_size: self.size
    valign: 'middle'
    halign: 'left'
    padding: '30dp', 0
    color: get_color_from_hex('#ff6600')


<LoginPage>:
    on_pre_enter: root.manager.parent.allow_touch_drag= False
    BoxLayout:
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: get_color_from_hex('#FF9966')
            Rectangle:
                size: self.size
                pos: self.pos
        BoxLayout:
            size_hint_y: None
            height: '80dp'
            Image:
                source: 'ic_action_cloudy.png'
                size_hint_x: None
                width: '80dp'
            Label:
                color: 1,1,1,1
                font_size: '18dp'
                bold: True
                text_size: self.size
                valign: 'middle'
                halign: 'left'
                padding: '30dp', 0
                text: 'Login'
        Image:
            source: 'line.png'
            size_hint_y: None
            height: '20dp'
        Label:
        SignLabel:
            text: 'Username:'
        CustomInput:
            size_hint_y: None
            height: '50dp'
            hint_text: 'Username'
            text: 'Username'
        SignLabel:
            text: 'Password:'
        BoxLayout:
            size_hint_y: None
            height: '50dp'
            CustomInput:
                hint_text: 'password'
                text: 'Password'
                password: True
                id: password
            IconToggle:
                size_hint_x: None
                width: '50dp'
                down_source: 'eye.png'
                normal_source: 'eye_closed.png'
                pos_hint: {'center_x':.5, 'center_y':.5}
                on_state:
                    if self.state == 'down': password.password=False
                    else: password.password=True
        Label:
        IconButton:
            size_hint_y: None
            height: '50dp'
            icon_source: 'login_button.png'
            normal_color: get_color_from_hex('#ff9966')
        Label:
        Label:
            size_hint_y: None
            height: self.texture_size[1]+8
            normal_color: get_color_from_hex('#FF9966')
            text: '[ref=forgot][color=#ff0000]forgot password[/color][/ref]'
            markup: True
            on_ref_press:
        Label:
            size_hint_y: None
            height: self.texture_size[1] +10
            markup: True
            text: "Don't you have an account  [ref=signin][color=#ff0000]Sign in[/color][/ref]"
            on_ref_press: root.parent.go_to_page('sign_in_page')

<SignInPage>:
    on_pre_enter: root.manager.parent.allow_touch_drag= False
    BoxLayout:
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: get_color_from_hex('#FF9966')
            Rectangle:
                size: self.size
                pos: self.pos
        BoxLayout:
            size_hint_y: None
            height: '80dp'
            Image:
                source: 'ic_action_cloudy.png'
                size_hint_x: None
                width: '80dp'
            Label:
                color: 1,1,1,1
                font_size: '18dp'
                bold: True
                text_size: self.size
                valign: 'middle'
                halign: 'left'
                padding: '30dp', 0
                text: 'Sign In'
        Image:
            source: 'line.png'
            size_hint_y: None
            height: '30dp'
        SignLabel:
            text: 'Email:'
        CustomInput:
            size_hint_y: None
            height: '50dp'
            hint_text: 'example@email.comm'
            text: 'Email'
        SignLabel:
            text: 'Username:'
        CustomInput:
            size_hint_y: None
            height: '50dp'
            hint_text: 'Username'
            text: 'Username'
        SignLabel:
            text: 'Password:'
        BoxLayout:
            size_hint_y: None
            height: '50dp'
            CustomInput:
                on_focus: if self.text.lower() == 'password': self.text = ''
                text: 'Password'
                password: True
                id: password
            IconToggle:
                size_hint_x: None
                width: '50dp'
                down_source: 'eye.png'
                normal_source: 'eye_closed.png'
                pos_hint: {'center_x':.5, 'center_y':.5}
                on_state:
                    if self.state == 'down': password.password=False
                    else: password.password=True
        SignLabel:
            text: 'Re entert Password'
        BoxLayout:
            size_hint_y: None
            height: '50dp'
            CustomInput:
                on_focus: if self.text.lower() == 'password': self.text = ''
                text: 'Password'
                password: True
                id: re_enter
            IconToggle:
                size_hint_x: None
                width: '50dp'
                down_source: 'eye.png'
                normal_source: 'eye_closed.png'
                pos_hint: {'center_x':.5, 'center_y':.5}
                on_state:
                    if self.state == 'down': re_enter.password=False
                    else: re_enter.password=True
        Label:
            text: '[color=#ff0000]Warning[/color]'
            markup: True
            id: warnig
        IconButton:
            size_hint_y: None
            height: '50dp'
            icon_source: 'sign_button.png'
            on_release: root.parent.go_to_page('login_page')
            normal_color: get_color_from_hex('#ff9966')


<FirstPage>:
    on_pre_enter: root.manager.parent.allow_touch_drag= False
    Carousel:
        canvas.before:
            Color:
                rgba: get_color_from_hex('#ff9966')
            Rectangle:
                size: self.size
                pos: self.pos
        BoxLayout:
            orientation: 'vertical'
            Label:
                size_hint_y: None
                height: '60dp'
                text: 'Upload and store material on the cloud'
                color: get_color_from_hex('#ff6600')
            AutoCarousel:
                AsyncImage:
                AsyncImage:
                AsyncImage:
            Image:
                source: 'first2.png'
                size_hint_y: None
                height: '60dp'
        BoxLayout:
            orientation: 'vertical'
            Label:
                size_hint_y: None
                height: '60dp'
                text: 'Upload and store material on the cloud'
                color: get_color_from_hex('#ff6600')
            AutoCarousel:
                AsyncImage:
                AsyncImage:
                AsyncImage:
            Image:
                source: 'first1.png'
                size_hint_y: None
                height: '60dp'
        BoxLayout:
            orientation: 'vertical'
            Label:
                size_hint_y: None
                height: '60dp'
                text: 'Upload and store material on the cloud'
                color: get_color_from_hex('#ff6600')
            AutoCarousel:
                AsyncImage:
                AsyncImage:
                AsyncImage:
            Image:
                source: 'first3.png'
                size_hint_y: None
                height: '60dp'

<UniCycleLayout@FocusBehavior+LayoutSelectionBehavior+RecycleBoxLayout>:

<UniCycle>:
    bar_color: get_color_from_hex('#CC6600aa')
    bar_inactive_color: get_color_from_hex('#CC660033')
    bar_width: '6dp'
    bar_margin: '4dp'
    scroll_type: ['bars', 'content']
    UniCycleLayout:
        default_size:  None, dp(60)
        default_size_hint: 1, None
        size_hint_y: None
        height: self.minimum_height
        orientation: 'vertical'
